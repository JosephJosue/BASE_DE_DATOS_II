INSERT INTO taller_03.perfiles (nombre_perfil, descripcion_perfil, fecha_vigencia_perfil, encargado_perfil) VALUES
	('Gerente de Proyectos', 'Responsable de la planificación y ejecución de proyectos.', '2026-12-31', 'Director de Operaciones'),
	('Desarrollador Senior', 'Lidera el desarrollo técnico y mentoriza a otros desarrolladores.', '2026-12-31', 'CTO'),
	('Analista de Datos', 'Extrae, procesa y analiza datos para la toma de decisiones.', '2026-12-31', 'Gerente de BI'),
	('Soporte TI Nivel 2', 'Provee soporte técnico especializado a los colaboradores.', '2026-12-31', 'Jefe de TI'),
	('Diseñador UX/UI', 'Crea las interfaces y experiencias de usuario para los productos.', '2026-12-31', 'Líder de Producto'),
	('Especialista en Marketing', 'Ejecuta campañas de marketing y comunicación.', '2026-12-31', 'Gerente de Marketing'),
	('Recursos Humanos', 'Gestiona el ciclo de vida del colaborador.', '2026-12-31', 'Director de RRHH'),
	('Contador', 'Responsable de la contabilidad y finanzas de la empresa.', '2026-12-31', 'CFO'),
	('Desarrollador Junior', 'Apoya en el desarrollo de software y corrección de errores.', '2026-12-31', 'Desarrollador Senior'),
	('Pasante de Operaciones', 'Brinda apoyo en tareas administrativas y operativas.', '2025-12-31', 'Gerente de Proyectos');

INSERT INTO taller_03.usuarios (nombre, apellido, estado, contrasena, cargo, salario, fecha_ingreso, id_perfil) VALUES
	('Ana', 'García', 'activo', '124521', 'Gerente de Proyectos', 5500.00, '2020-03-15', 1),
	('Luis', 'Martinez', 'activo', 'asd3241', 'Desarrollador Senior', 4800.00, '2019-07-22', 2),
	('Sofía', 'Hernández', 'activo', 'ajhsgd12', 'Analista de Datos', 3900.00, '2021-01-10', 3),
	('Carlos', 'López', 'activo', 'kasjdgey124', 'Soporte TI Nivel 2', 3200.00, '2020-11-05', 4),
	('Valentina', 'Díaz', 'activo', 'asjsbcy46', 'Diseñador UX/UI', 4100.00, '2022-02-20', 5),
	('Javier', 'Pérez', 'activo', 'jsjirne234', 'Especialista en Marketing', 3800.00, '2021-08-17', 6),
	('Camila', 'Gómez', 'activo', 'ksoeeu873', 'Recursos Humanos', 4200.00, '2018-05-30', 7),
	('Mateo', 'Rodríguez', 'activo', 'lsoeei7363', 'Contador', 4500.00, '2019-09-01', 8),
	('Isabella', 'Sánchez', 'activo', 'pierndue73', 'Desarrollador Junior', 2800.00, '2023-06-12', 9),
	('Daniel', 'Ramírez', 'activo', 'mvrbwl83', 'Pasante de Operaciones', 1500.00, '2024-02-01', 10),
	('Gabriela', 'Torres', 'activo', 'ornruv983', 'Desarrollador Senior', 5000.00, '2020-08-19', 2),
	('Miguel', 'Flores', 'activo', 'mibcrm09', 'Analista de Datos', 4000.00, '2022-05-14', 3),
	('Lucía', 'Rivera', 'activo', '89364673', 'Soporte TI Nivel 2', 3300.00, '2021-12-09', 4),
	('Sebastián', 'Vargas', 'activo', 'induen8363', 'Desarrollador Junior', 2900.00, '2023-07-21', 9),
	('Elena', 'Castro', 'inactivo', 'lmdienu77363', 'Especialista en Marketing', 3700.00, '2020-01-25', 6),
	('David', 'Morales', 'activo', 'ndnueb765', 'Gerente de Proyectos', 5800.00, '2019-04-11', 1),
	('Paula', 'Ortega', 'activo', 'miencyebe7252', 'Recursos Humanos', 4300.00, '2022-10-03', 7),
	('Adrián', 'Jiménez', 'activo', '7625hehuy', 'Desarrollador Junior', 2850.00, '2024-01-15', 9),
	('Renata', 'Reyes', 'activo', 'kkandu7725', 'Diseñador UX/UI', 4150.00, '2023-03-28', 5),
	('Emilio', 'Mendoza', 'activo', 'keneuue7373', 'Desarrollador Senior', 5100.00, '2018-11-10', 2);

INSERT INTO taller_03.login (id_usuario, fecha_hora_login, estado_login) VALUES
	(2, '2024-07-05 08:02:11', 'exitoso'),
	(11, '2024-07-05 08:05:34', 'exitoso'),
	(5, '2024-07-08 09:15:22', 'exitoso'),
	(1, '2024-07-09 08:00:56', 'exitoso'),
	(18, '2024-07-10 11:30:04', 'fallido'),
	(18, '2024-07-10 11:30:45', 'exitoso'),
	(3, '2024-07-11 08:21:51', 'exitoso'),
	(7, '2024-07-12 14:05:00', 'exitoso'),
	(2, '2024-07-15 08:03:19', 'exitoso'),
	(14, '2024-08-01 09:00:03', 'exitoso'),
	(9, '2024-08-02 09:10:17', 'exitoso'),
	(16, '2024-08-05 10:11:30', 'exitoso'),
	(1, '2024-08-06 08:01:13', 'exitoso'),
	(8, '2024-08-07 08:30:49', 'exitoso'),
	(12, '2024-08-12 09:05:22', 'fallido'),
	(12, '2024-08-12 09:05:55', 'exitoso'),
	(5, '2024-08-15 11:45:10', 'exitoso'),
	(19, '2024-08-20 09:00:33', 'exitoso'),
	(6, '2024-09-02 08:55:41', 'exitoso'),
	(20, '2024-09-03 10:00:01', 'exitoso'),
	(1, '2024-09-04 08:02:30', 'exitoso'),
	(13, '2024-09-05 09:20:18', 'exitoso'),
	(4, '2024-09-09 08:10:00', 'exitoso'),
	(17, '2024-09-10 09:01:02', 'exitoso'),
	(2, '2024-09-11 08:04:09', 'exitoso'),
	(10, '2024-10-01 09:00:12', 'exitoso'),
	(3, '2024-10-02 08:25:34', 'exitoso'),
	(15, '2024-10-03 11:00:00', 'exitoso'),
	(11, '2024-10-07 08:14:29', 'exitoso'),
	(7, '2024-10-08 14:10:15', 'exitoso'),
	(1, '2024-10-09 08:00:59', 'exitoso'),
	(18, '2024-11-04 11:33:40', 'exitoso'),
	(5, '2024-11-05 09:18:27', 'exitoso'),
	(9, '2024-11-06 09:12:08', 'exitoso'),
	(2, '2024-11-07 08:05:11', 'fallido'),
	(2, '2024-11-07 08:05:32', 'exitoso'),
	(12, '2024-11-12 09:08:44', 'exitoso'),
	(6, '2024-11-13 08:58:21', 'exitoso'),
	(20, '2024-12-02 10:03:19', 'exitoso'),
	(1, '2024-12-03 08:01:45', 'exitoso'),
	(8, '2024-12-04 08:33:01', 'exitoso'),
	(19, '2024-12-05 09:02:48', 'exitoso'),
	(4, '2025-01-06 08:15:19', 'exitoso'),
	(14, '2025-01-07 09:03:00', 'exitoso'),
	(10, '2025-01-08 09:01:22', 'fallido'),
	(10, '2025-01-08 09:01:45', 'exitoso'),
	(2, '2025-01-09 08:06:51', 'exitoso'),
	(3, '2025-01-13 08:28:13', 'exitoso'),
	(17, '2025-01-14 09:03:33', 'exitoso'),
	(1, '2025-01-15 08:02:18', 'exitoso'),
	(7, '2025-02-03 14:15:29', 'exitoso'),
	(13, '2025-02-04 09:23:44', 'exitoso'),
	(11, '2025-02-05 08:18:00', 'exitoso'),
	(5, '2025-02-06 09:20:05', 'exitoso'),
	(16, '2025-02-10 10:15:47', 'exitoso'),
	(2, '2025-02-11 08:07:33', 'exitoso'),
	(6, '2025-02-12 09:01:11', 'exitoso'),
	(1, '2025-02-13 08:03:00', 'exitoso'),
	(18, '2025-02-14 11:35:14', 'exitoso'),
	(20, '2025-03-03 10:05:00', 'exitoso'),
	(9, '2025-03-04 09:15:39', 'exitoso'),
	(12, '2025-03-05 09:10:07', 'fallido'),
	(12, '2025-03-05 09:10:29', 'exitoso'),
	(8, '2025-03-06 08:35:50', 'exitoso'),
	(1, '2025-03-10 08:01:07', 'exitoso'),
	(19, '2025-03-11 09:05:00', 'exitoso'),
	(4, '2025-03-12 08:18:29', 'exitoso'),
	(2, '2025-03-13 08:08:41', 'exitoso'),
	(14, '2025-04-01 09:05:33', 'exitoso'),
	(3, '2025-04-02 08:30:00', 'exitoso'),
	(17, '2025-04-03 09:05:19', 'exitoso'),
	(1, '2025-04-07 08:00:25', 'exitoso'),
	(11, '2025-04-08 08:20:10', 'exitoso'),
	(7, '2025-04-09 14:20:00', 'exitoso'),
	(5, '2025-04-10 09:22:45', 'exitoso'),
	(2, '2025-04-14 08:09:56', 'exitoso'),
	(13, '2025-04-15 09:25:01', 'fallido'),
	(13, '2025-04-15 09:25:21', 'exitoso'),
	(1, '2025-05-01 08:05:00', 'exitoso'),
	(6, '2025-05-05 09:03:22', 'exitoso'),
	(16, '2025-05-06 10:20:00', 'exitoso'),
	(18, '2025-05-07 11:40:10', 'exitoso'),
	(9, '2025-05-08 09:18:44', 'exitoso'),
	(20, '2025-05-12 10:08:15', 'exitoso'),
	(1, '2025-05-13 08:02:49', 'exitoso'),
	(8, '2025-05-14 08:38:00', 'exitoso'),
	(12, '2025-05-15 09:12:12', 'exitoso'),
	(2, '2025-05-19 08:10:04', 'exitoso'),
	(19, '2025-05-20 09:08:21', 'exitoso'),
	(1, '2025-06-02 08:01:50', 'exitoso'),
	(4, '2025-06-03 08:20:30', 'exitoso'),
	(3, '2025-06-04 08:33:14', 'exitoso'),
	(11, '2025-06-05 08:22:00', 'exitoso'),
	(10, '2025-06-09 09:05:10', 'exitoso'),
	(2, '2025-06-10 08:11:15', 'exitoso'),
	(5, '2025-06-11 09:25:00', 'exitoso'),
	(1, '2025-06-12 08:03:33', 'exitoso'),
	(7, '2025-06-13 15:00:00', 'exitoso'),
	(2, '2025-06-17 08:01:15', 'exitoso'),
	(11, '2025-06-18 08:06:24', 'exitoso');

INSERT INTO taller_03.actividades (tipo_actividad, descripcion_actividad, puntos_otorgados, fecha_actividad) VALUES
	('Capacitación', 'Taller de Liderazgo', 50, '2024-07-15'), 
	('Bienestar', 'Clase de Yoga online', 30, '2024-07-28'),
	('Voluntariado', 'Jornada de reforestación', 100, '2024-08-12'), 
	('Técnica', 'Curso de SQL Avanzado', 70, '2024-08-25'),
	('Integración', 'Día de campo familiar', 40, '2024-09-18'), 
	('Salud', 'Charla de nutrición', 25, '2024-09-30'),
	('Técnica', 'Bootcamp de Python', 80, '2024-10-14'), 
	('Cultural', 'Visita al museo local', 35, '2024-10-26'),
	('Bienestar', 'Taller de manejo del estrés', 50, '2024-11-11'), 
	('Social', 'Cena de fin de año', 60, '2024-11-29'),
	('Voluntariado', 'Colecta de juguetes navideños', 100, '2024-12-15'), 
	('Integración', 'Intercambio de regalos', 20, '2024-12-22'),
	('Planificación', 'Kick-off Anual 2025', 40, '2025-01-10'), 
	('Salud', 'Campaña de vacunación', 30, '2025-01-24'),
	('Técnica', 'Workshop de metodologías ágiles', 75, '2025-02-13'), 
	('Cultural', 'Concurso de fotografía', 50, '2025-02-27'),
	('Bienestar', 'Semana de la salud mental', 60, '2025-03-10'), 
	('Capacitación', 'Curso de oratoria', 55, '2025-03-25'),
	('Integración', 'Torneo deportivo', 80, '2025-04-12'), 
	('Social', 'Celebración de aniversario', 45, '2025-04-28'),
	('Voluntariado', 'Limpieza de playa', 100, '2025-05-17'), 
	('Técnica', 'Charla sobre IA generativa', 70, '2025-05-29'),
	('Capacitación', 'Taller de Excel para finanzas', 65, '2025-06-10'), 
	('Bienestar', 'Pausas activas dirigidas', 30, '2025-06-18');

INSERT INTO taller_03.participacion_actividades (id_usuario, id_actividad) VALUES
	(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10),
	(11, 11), (12, 12), (13, 13), (14, 14), (1, 15), (2, 16), (3, 17), (4, 18), (5, 19), (6, 20),
	(7, 21), (8, 22), (9, 23), (10, 24), (11, 1), (12, 2), (13, 3), (14, 4), (16, 5), (17, 6),
	(18, 7), (19, 8), (20, 9), (1, 10), (2, 11), (3, 12), (4, 13), (5, 14), (6, 15), (7, 16),
	(8, 17), (9, 18), (10, 19), (11, 20), (12, 21), (13, 22), (14, 23), (16, 24), (17, 1), (20, 4);


SELECT u.id_usuario, u.nombre, u.apellido, u.cargo, SUM(a.puntos_otorgados) AS total_puntos_fidelizacion
FROM taller_03.usuarios u
INNER JOIN taller_03.participacion_actividades pa ON u.id_usuario = pa.id_usuario
INNER JOIN taller_03.actividades a ON pa.id_actividad = a.id_actividad
GROUP BY u.id_usuario, u.nombre, u.apellido, u.cargo
ORDER BY total_puntos_fidelizacion DESC;





